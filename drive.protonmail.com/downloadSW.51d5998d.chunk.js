!function(){"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const e={"Content-Security-Policy":"default-src 'none'","X-Content-Security-Policy":"default-src 'none'","X-WebKit-CSP":"default-src 'none'","Referrer-Policy":"strict-origin-when-cross-origin","Strict-Transport-Security":"max-age=31536000","X-Content-Type-Options":"nosniff","X-Frame-Options":"deny","X-XSS-Protection":"1; mode=block","X-Permitted-Cross-Domain-Policies":"none"};function createDownloadStream(e){return new ReadableStream({start(t){e.onmessage=({data:e})=>{switch(null==e?void 0:e.action){case"end":return t.close();case"download_chunk":return t.enqueue(null==e?void 0:e.payload);case"abort":return t.error(null==e?void 0:e.reason);default:console.error('received unknown action "'.concat(null==e?void 0:e.action,'"'))}}},cancel(){e.postMessage({action:"download_canceled"})}})}new class DownloadServiceWorker{constructor(){this.pendingDownloads=new Map,this.onInstall=()=>{self.skipWaiting()},this.onActivate=e=>{e.waitUntil(self.clients.claim())},this.onFetch=t=>{const{url:n}=t.request;if(n.endsWith("/sw/ping"))return t.respondWith(new Response("pong",{headers:new Headers(e)}));const o=this.pendingDownloads.get(n);if(!o)return;const{stream:r,filename:s,size:a,mimeType:i}=o;this.pendingDownloads.delete(n);const c=new Headers(_objectSpread(_objectSpread({},a?{"Content-Length":"".concat(a)}:{}),{},{"Content-Type":i,"Content-Disposition":'attachment; filename="'.concat(encodeURI(s),'"')},e));t.respondWith(new Response(r,{headers:c}))},this.onMessage=e=>{var t;if("start_download"!==(null===(t=e.data)||void 0===t?void 0:t.action))return;const{filename:n,mimeType:o,size:r}=e.data.payload,s=encodeURI("".concat(self.registration.scope,"sw/").concat(Math.random(),"/").concat(n)),a=e.ports[0];this.pendingDownloads.set(s,{stream:createDownloadStream(a),filename:n,mimeType:o,size:r,port:a}),a.postMessage({action:"download_started",payload:s})},self.addEventListener("install",this.onInstall),self.addEventListener("activate",this.onActivate),self.addEventListener("message",this.onMessage),self.addEventListener("fetch",this.onFetch)}}}();
//# sourceMappingURL=downloadSW.51d5998d.chunk.js.map